<!DOCTYPE html>
{% import "macros.html" as macros with context %}
<html lang="en" data-theme="dark">
<head>
  <meta charset="UTF-8">
  <meta content="width=device-width, initial-scale=1" name="viewport">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.8.1/font/bootstrap-icons.css">
  <link href="static/favicon.svg" rel="icon" type="image/x-icon"/>
  <link crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" rel="stylesheet">
  <script crossorigin="anonymous" integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p" src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
  <link href="{{ url_for('static', filename='css/main.css') }}" rel="stylesheet">
</head>
<nav id="navContent" class="nav-vertical">
    <div class="text-center mb-4 pb-4 border-bottom">
        <a class="bi bi-stickies-fill" href="{{ url_for('index') }}" style="font-size: 3em"></a><br>
        <a class="font-custom-2 dropdown-toggle" data-bs-toggle="dropdown"><i class="bi bi-person-fill"></i> {{ current_user.username }}</a>
        <div class="dropdown-menu dropdown-menu-end text-center">
            {% if current_user.is_authenticated %}
            <a class="dropdown-item" href="{{ url_for('account') }}">Account</a>
            <a class="dropdown-item" href="{{ url_for('logout') }}">Sign Out</a>
            {% else %}
            <a class="dropdown-item" data-bs-target="#login" data-bs-toggle="modal" href="#">Log In</a>
            <a class="dropdown-item" data-bs-target="#signup" data-bs-toggle="modal" href="#">Sign Up</a>
            {% endif %}
        </div>
    </div>
    <div>
        {% if not current_user.is_anonymous %}
        <form action="{{ url_for('notes.search') }}" class="input-group" method="POST">
            <input autocomplete="off" class="input-custom" name="search_term" placeholder="Search" type="search">
        </form>
        
        <div class="my-3">
            <a class="text-success font-custom" data-bs-toggle="modal" data-bs-target="#newNote"><i class="bi bi-sticky-fill"></i> + new note</a>
        </div>
        
        <div class="my-3">
            <a onclick="toggleDiv('favorites')" class="dropdown-toggle font-custom text-warning"><i class="bi bi-star-fill"></i> favorites <small>- {{ current_user.get_notes(filter_='favorited').count() }}</small></a>
            <div class="ps-3" id="favorites">
            {% for i in current_user.get_notes(filter_='favorited') %}
            <div>
                <a href="{{ url_for('notes.note', id_=i.id) }}" class="font-custom-2"><i style="color: {{ i.folders.color }}" class="bi bi-sticky-fill"></i> {{ i.title }}</a>
            </div>
            {% endfor %}
            </div>
        </div>
        <div class="my-3">
            <a onclick="toggleDiv('folders')" class="dropdown-toggle font-custom"><i class="bi bi-folder-fill"></i> folders <small>- {{ current_user.get_folders().count() }}</small></a>
            <div class="ps-3" id="folders">
            {% for i in current_user.get_folders() %}
            <div>
                <a href="{{ url_for('folders.folder', id_=i.id) }}" class="font-custom-2"><i style="color: {{ i.color }}" class="bi bi-folder-fill"></i> {{ i.name }} <small>- {{ i.get_notes().count() }}</small></a>
            </div>
            {% endfor %}
            <a class="text-success font-custom" data-bs-toggle="modal" data-bs-target="#newFolder"><i class="bi bi-folder-fill"></i> + new folder</a>
            </div>
        </div>
        <div class="my-3">
            <a href="{{ url_for('links.links_') }}" class="font-custom"><i class="bi bi-link-45deg"></i> links <small>- {{ current_user.get_links(filter_='not been_read').count() }}</small></a>
        </div>
        {% endif %}
                
        
        <a class="dropdown-toggle font-custom" data-bs-toggle="dropdown" data-bs-target="#themeDD"><i class="bi bi-circle-half"></i> change theme</a>
        
        <div id="themeDD" class="dropdown-menu">
            <a class="dropdown-item" onclick="changeTheme('light')">light</a>
            <a class="dropdown-item" onclick="changeTheme('dark')">dark</a>
        </div>
    </div>
</nav>
    {% if not current_user.is_anonymous %}
    {% call macros.modal('newFolder') %}
    {{ macros.folder_create_form() }}
    {% endcall %}
    
    {% call macros.modal('newNote') %}
    {{ macros.note_create_form() }}
    {% endcall %}
    {% endif %}
    
    {% call macros.modal('signup') %}
    {{ macros.signup_form() }}
    {% endcall %}

    {% call macros.modal('login') %}
    {{ macros.login_form() }}
    {% endcall %}
    
<div class="" id="pageContent">
  <span class="spinner-border spinner-border-sm" id="spinner" style="display:none"></span>
  <a class="expand-this bi bi-list sticky-top p-1" onclick="toggleDiv('navContent')" style="display: none; font-size: 2em"></a>
  {% block body %}
  {% endblock %}
  <script crossorigin="anonymous" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  <script src="{{ url_for('static', filename='main.js') }}"></script>
</div>
</html>
